<!-- Conversation List -->
<div
        x-data="conversationsComponent('{{list_conversations_api}}', '{{delete_conversation_api}}')"
        x-init="loadMore()"
        @scroll.passive="handleScroll($event)"
        class="h-full overflow-y-auto bg-black space-y-4"
>

    <!-- Bulk Actions Bar -->
    <div class="flex justify-between items-center mb-2" x-show="selectedIds.length > 0">
        <span class="text-gray-400 text-sm" x-text="selectedIds.length + ' selected'"></span>
        <button
                @click="deleteSelected()"
                class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-md text-sm"
        >
            Delete
        </button>
    </div>

    <!-- No conversations message -->
    <div
            x-show="!loading && conversationsList.length === 0"
            class="text-center text-gray-400 py-12"
    >
        <i class="ri-chat-off-line ri-4x mb-2"></i>
        <p>No conversations yet</p>
    </div>

    <!-- Conversation Items -->
    <template x-for="conversation in conversationsList" :key="conversation.id">
        <div
                class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-900"
                :class="!conversation.is_read ? 'bg-gray-800' : '' ">
            <!-- Checkbox -->
            <input
                    type="checkbox"
                    :value="conversation.id"
                    @change="toggleSelection(conversation.id, $event.target.checked)"
                    class="form-checkbox text-blue-600 rounded"
            >
            <!-- Conversation Link -->
            <a :href="'/inbox/messages/' + conversation.username" class="flex items-center gap-3 flex-1">
                <div class="relative">
                    <div class="w-12 h-12 rounded-full overflow-hidden">
                        <img
                                :src="conversation.profile_picture"
                                alt="User"
                                class="w-full h-full object-cover"
                        />
                    </div>
                    <template x-if="conversation.is_online">
                        <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-black"></div>
                    </template>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex justify-between">
                        <span class="font-medium text-white" x-text="conversation.username"></span>
                        <span class="text-xs text-gray-400" x-text="conversation.updated_at"></span>
                    </div>
                    <div class="flex justify-between items-center">
                        <p
                                class="text-sm truncate text-wrap"
                                :class="conversation.is_read ? 'text-gray-400' : 'text-white font-semibold'"
                                x-text="conversation.last_message"
                        ></p>
                    </div>
                </div>
            </a>
        </div>
    </template>

    <!-- Loading Indicator -->
    <div x-show="loading" class="text-center text-gray-400 p-4">
        Loading...
    </div>
</div>
